# UI 设计文档：LLM 配置页面（模型选择与连接）

> **原型图参考**：Image 2 - LLM 配置管理界面  
> **对应功能**：AI 模型选择、API Key 输入、连接测试、模型启用/禁用

---

## 1. 整体布局

### 1.1 页面属性
- **页面类型**：主窗口内容区域（非浮窗）
- **尺寸**：全屏适配，宽度 1200px~，高度 800px~
- **背景**：浅白色 `#F5F7FA`（桌面应用通常背景较亮）
- **滚动**：页面内容超高时支持垂直滚动

### 1.2 结构布局（从上到下）
```
┌──────────────────────────────────────────────────────┐
│ [侧边栏导航]           [主内容区]                    │
│                                                      │
│ ◆ 总览              LLM 配置                        │
│ ◆ 攻略对象          管理你的 AI 模型配置，添加新模型并设置默认值。
│ ◆ 对话编辑器        
│ ◆ LLM配置(✓)        ┌──────────────────────────────┐
│ ◆ 设置             │ + 添加新模型      [组件预留]  │
│                    └──────────────────────────────┘
│                    
│                    ┌──────────────────────────────┐
│ [帮助]             │ GPT-4o (OpenAI)              │
│ [报告问题]         │ ● 已激活                     │
│ [登出]             │ ┌──────────────────────────┐ │
│                    │ │ gpt-4o                  │ │ 
│                    │ │ OpenAI 官方最强模型     │ │
│                    │ │ [编辑] [删除]           │ │
│                    │ └──────────────────────────┘ │
│                    │ ⚙ 设为默认  ☆ 收藏  🗑 删除 │
│                    └──────────────────────────────┘
│                    
│                    ┌──────────────────────────────┐
│                    │ Claude 3 Opus (Anthropic)    │
│                    │ ◯ 未激活                     │
│                    │ ┌──────────────────────────┐ │
│                    │ │ claude-3-opus-...       │ │
│                    │ │ 情感理解更好的模型      │ │
│                    │ │ [编辑] [连接测试]       │ │
│                    │ └──────────────────────────┘ │
│                    │ ⚙ 设为默认  ☆ 收藏  🗑 删除 │
│                    └──────────────────────────────┘
│                    
│                    ┌──────────────────────────────┐
│                    │ 本地 Llama 3 (Oobabooga)     │
│                    │ ⚠ 连接错误                    │
│                    │ ┌──────────────────────────┐ │
│                    │ │ 本地 Oobabooga           │ │
│                    │ │ 隐私友好的本地模型      │ │
│                    │ │ [编辑] [重新连接]       │ │
│                    │ └──────────────────────────┘ │
│                    │ ⚙ 设为默认  ☆ 收藏  🗑 删除 │
│                    └──────────────────────────────┘
│                    
│                    [+ 添加你的第一个 AI 模型]
│                    从头开始一段新对话。连接到 OpenAI、
│                    Anthropic 或本地实例。
│
└──────────────────────────────────────────────────────┘
```

---

## 2. 侧边栏导航

### 2.1 容器属性
- **宽度**：280px（固定）
- **背景**：品牌粉红色渐变 `linear-gradient(135deg, #D91B5C 0%, #C2185B 100%)`
- **高度**：100vh
- **内边距**：20px 0
- **位置**：绝对定位或 Flexbox 容器左侧
- **滚动**：如果导航项超过高度，启用滚动

### 2.2 导航项结构
```
◆ 总览
◆ 攻略对象
◆ 对话编辑器
◆ LLM配置 ✓
◆ 设置
```

**每个导航项样式**：
- **文字颜色**：
  - 默认：`rgba(255, 255, 255, 0.7)`
  - Hover：`#FFF`
  - Active（当前页）：`#FFF`
- **字体**：15px，行高 2.0（项目间距 30px）
- **左内边距**：24px（缩进）
- **背景**：
  - 默认：透明
  - Hover：`rgba(255, 255, 255, 0.1)`
  - Active：`rgba(255, 255, 255, 0.2)`，左边有 3px 白色竖线指示器
- **图标**：每项前有小菱形 `◆`（24px 从左边距），颜色与文字同步

### 2.3 底部功能区（stickied 到底部）
```
[帮助图标] 帮助
[报告图标] 报告问题
[登出图标] 登出
```

- **位置**：绝对定位 `bottom: 20px, left: 0, right: 0`
- **样式**：
  - 背景：`rgba(255, 255, 255, 0.1)`
  - 边框顶部：1px solid `rgba(255, 255, 255, 0.2)`
  - 内边距：16px 24px
  - 每项高 40px，间距 8px
- **文字**：13px，颜色 `rgba(255, 255, 255, 0.7)`
- **图标**：左侧 16×16px，右侧箭头 (→)
- **Hover**：背景变为 `rgba(255, 255, 255, 0.15)`，文字变白

---

## 3. 顶部标题栏（主内容区上方）

### 3.1 标题栏布局
```
LLM 配置                                    [+ 添加新模型]
管理你的 AI 模型配置，添加新模型并设置默认值。
```

- **高度**：80px
- **背景**：白色 `#FFFFFF`
- **边框**：底部 1px solid `#E5E7EB`
- **内边距**：20px 40px
- **布局**：Flexbox 列方向

### 3.2 标题
- **文字**：`LLM 配置`
- **字体**：28px，粗体 700，颜色 `#1F2937`
- **下边距**：8px

### 3.3 副标题 + 操作按钮
- **布局**：Flex row，`justify-content: space-between`
- **副标题**：
  - 文字：`管理你的 AI 模型配置，添加新模型并设置默认值。`
  - 字体：14px，颜色 `#6B7280`
- **按钮**：`+ 添加新模型`
  - 背景：品牌粉红 `#D91B5C`
  - 文字：白色，14px 粗体
  - 内边距：10px 20px
  - 圆角：8px
  - Hover：背景变深 `#C2185B`
  - 阴影：`0 2px 4px rgba(0,0,0,0.1)`

---

## 4. 模型卡片（核心内容）

### 4.1 卡片容器
```
┌─────────────────────────────────────────────────┐
│ GPT-4o (OpenAI)                                 │
│ ● 已激活                                         │
│ ┌────────────────────────────────────────────┐  │
│ │ gpt-4o                                      │  │
│ │ OpenAI 官方最强模型。准确率 98%+，适合  │  │
│ │ 多轮对话与情感分析。                       │  │
│ │ [编辑] [连接测试]                          │  │
│ └────────────────────────────────────────────┘  │
│ ⚙ 设为默认  ☆ 收藏  🗑 删除                    │
└─────────────────────────────────────────────────┘
```

**卡片样式**：
- **背景**：白色 `#FFFFFF`
- **圆角**：12px
- **边框**：1px solid `#E5E7EB`
- **阴影**：`0 1px 3px rgba(0, 0, 0, 0.1)`，hover 时升高到 `0 4px 12px rgba(0, 0, 0, 0.15)`
- **内边距**：20px
- **间距**：卡片之间 16px
- **过渡**：所有变化 200ms ease
- **最大宽度**：800px（居中对齐）

### 4.2 卡片头部（标题 + 状态）
- **布局**：Flex row，`justify-content: space-between, align-items: center`
- **左侧**：
  - **标题**：`GPT-4o (OpenAI)`，字体 18px 粗体 600，颜色 `#1F2937`
- **右侧**：
  - **状态指示器**（3 种）：
    1. 已激活：`● 已激活`，颜色绿色 `#10B981`
    2. 未激活：`◯ 未激活`，颜色灰色 `#9CA3AF`
    3. 连接错误：`⚠ 连接错误`，颜色红色 `#EF4444`
  - 字体：13px，粗体 500
  - 右边距：0px

### 4.3 卡片主体（模型信息）
- **背景**：`#F9FAFB`（极浅灰）
- **圆角**：8px
- **内边距**：12px 16px
- **字体**：13px，行高 1.6
- **内容**：
  - 第一行：模型 ID（`gpt-4o`），字体粗体 500，颜色 `#1F2937`
  - 第二行：模型描述（`OpenAI 官方最强模型...`），颜色 `#6B7280`
  - 第三行：按钮组 `[编辑] [连接测试]` 或根据状态显示

### 4.4 卡片底部（操作栏）
- **布局**：Flex row，`justify-content: flex-start, gap: 16px`
- **操作按钮**（4 个，按序）：
  1. **⚙ 设为默认**
     - 尺寸：高 32px，宽 120px
     - 背景：透明，边框 1px `#D1D5DB`
     - 文字：13px，颜色 `#374151`
     - Hover：背景 `#F3F4F6`，边框 `#9CA3AF`
  
  2. **☆ 收藏**（未收藏状态）或 **★ 已收藏**（已收藏状态）
     - 尺寸：高 32px，宽 100px
     - 背景：透明，边框 1px `#D1D5DB`
     - 文字：13px
     - 未收藏：颜色 `#6B7280`
     - 已收藏：颜色 `#FCD34D`（金黄色），边框 `#FCD34D`
  
  3. **🗑 删除**
     - 尺寸：高 32px，宽 100px
     - 背景：透明，边框 1px `#FCA5A5`（淡红）
     - 文字：13px，颜色 `#EF4444`（红）
     - Hover：背景 `#FEE2E2`
  
  4. **编辑按钮**（仅在卡片主体中显示）
     - 位置：模型信息底部，与"连接测试"并排
     - 尺寸：高 28px，宽 60px
     - 背景：品牌粉色 `#D91B5C`
     - 文字：12px，颜色白色
     - 圆角：4px
     - Hover：背景 `#C2185B`

### 4.5 条件渲染规则
根据模型连接状态，卡片内容和按钮不同：

| 状态 | 卡片右侧指示器 | 背景色调整 | 可用按钮 |
|------|---|---|---|
| 已激活 | ● 绿色 | 无调整 | 设为默认、收藏、编辑、删除、连接测试 |
| 未激活 | ◯ 灰色 | 轻度灰化 opacity 0.6 | 设为默认、收藏、编辑、删除、连接测试 |
| 连接错误 | ⚠ 红色 | 轻度红化 opacity 0.8 | 设为默认、收藏、编辑、删除、重新连接 |

---

## 5. 模态对话：添加新模型

### 5.1 对话框属性
触发方式：点击"+ 添加新模型"按钮或空卡片上的链接

- **宽度**：600px
- **背景**：白色 `#FFFFFF`
- **圆角**：12px
- **阴影**：`0 10px 40px rgba(0, 0, 0, 0.2)`
- **z-index**：确保在所有内容上方

### 5.2 对话框结构
```
┌────────────────────────────────────────┐
│ 添加 AI 模型                        [×] │
├────────────────────────────────────────┤
│ 选择模型供应商：                       │
│ ┌──────────────────────────────────┐  │
│ │ OpenAI (GPT-4o, GPT-3.5...)   ▼ │  │ ← Dropdown
│ └──────────────────────────────────┘  │
│                                        │
│ API Key / 认证信息：                   │
│ ┌──────────────────────────────────┐  │
│ │ sk-proj-xxxxx... (粘贴你的 key) │  │ ← Input
│ └──────────────────────────────────┘  │
│                                        │
│ [测试连接]        [保存]  [取消]       │
└────────────────────────────────────────┘
```

### 5.3 字段定义

#### 供应商选择器
- **标签**：`选择模型供应商：`，14px 粗体 600
- **下拉框**：
  - 选项：
    - OpenAI (GPT-4o, GPT-3.5...)
    - Anthropic (Claude 3 Opus, Sonnet...)
    - 本地 (Ollama, Oobabooga, Vllm...)
    - 自定义 API (兼容 OpenAI 格式)
  - 高度：40px
  - 背景：`#F9FAFB`，边框 1px `#D1D5DB`
  - 文字：14px，颜色 `#1F2937`
  - 圆角：6px
  - 内边距：10px 12px
  - Hover：边框 `#9CA3AF`

#### API Key 输入框
- **标签**：`API Key / 认证信息：`，14px 粗体 600，下边距 8px
- **输入框**：
  - 高度：40px
  - 背景：`#F9FAFB`，边框 1px `#D1D5DB`
  - 文字：13px，颜色 `#374151`
  - 圆角：6px
  - 内边距：10px 12px
  - Placeholder：`粘贴你的 API Key（仅本地存储，不上传）`，颜色 `#9CA3AF`
  - Focus：边框变为品牌粉色 `#D91B5C`，阴影 `0 0 0 3px rgba(217, 27, 92, 0.1)`
  - 密码隐藏：启用密码显示切换按钮（👁 符号）

#### 高级选项（可折叠）
- **折叠标题**：`⚙ 高级选项`，13px，颜色 `#6B7280`
- **展开内容**（不详细列出）：
  - 模型名称自定义（override 模型 ID）
  - 温度系数（Temperature）滑块 0.0 ~ 2.0
  - 最大 Token 数量
  - 代理设置（可选）

### 5.4 按钮栏
```
[测试连接]        [保存]  [取消]
```

- **布局**：Flex row，`justify-content: space-between, align-items: center`
- **左侧**：
  - **[测试连接]** 按钮
    - 背景：蓝色 `#3B82F6`
    - 文字：白色，13px 粗体
    - 内边距：10px 20px
    - 圆角：6px
    - Hover：背景 `#2563EB`
    - 状态：点击后显示加载动画，完成后显示 "✓ 连接成功" 或 "✗ 连接失败"

- **右侧**：
  - **[保存]** 按钮
    - 背景：品牌粉红 `#D91B5C`
    - 文字：白色，13px 粗体
    - 内边距：10px 24px
    - 圆角：6px
    - Hover：背景 `#C2185B`
    - 禁用状态（未测试连接时）：opacity 0.5，pointer-events none

  - **[取消]** 按钮
    - 背景：透明，边框 1px `#D1D5DB`
    - 文字：`#374151`，13px 粗体
    - 内边距：10px 24px
    - 圆角：6px
    - Hover：背景 `#F3F4F6`

### 5.5 测试连接反馈
- **进行中**：按钮显示加载动画（旋转圆形），文字变为 "测试中..."
- **成功**：
  - 按钮变绿 `#10B981`
  - 文字：`✓ 连接成功`
  - 下方显示绿色提示信息：`API Key 有效，模型 gpt-4o 可用`
  - 延迟 1.5 秒后，自动恢复为 "测试连接" 状态
- **失败**：
  - 按钮变红 `#EF4444`
  - 文字：`✗ 连接失败`
  - 下方显示红色错误信息：`API Key 无效或网络错误：Unauthorized`
  - 用户可以点击"查看详情"展开错误日志

---

## 6. 空状态

### 6.1 无模型已配置
```
┌────────────────────────────────────────┐
│                                        │
│          [⊕ 大图标]                   │
│                                        │
│     尚未配置模型                       │
│                                        │
│  通过添加你的第一个 AI 模型配置并开始。│
│  连接到 OpenAI、Anthropic 或本地实例。 │
│                                        │
│      [+ 添加你的第一个 AI 模型]       │
│                                        │
└────────────────────────────────────────┘
```

**样式**：
- **背景**：白色卡片，圆角 12px，边框 2px dashed `#E5E7EB`
- **内容对齐**：居中
- **图标**：`⊕`，尺寸 48px，颜色 `#D1D5DB`
- **标题**：`尚未配置模型`，18px 粗体 600，颜色 `#1F2937`，下边距 8px
- **描述**：14px，颜色 `#6B7280`，行高 1.6
- **按钮**：同"添加新模型"按钮样式

---

## 7. 交互动画与过渡

### 7.1 卡片加载动画
- 新增卡片从底部滑入（300ms ease-out）
- 从 `translateY(20px), opacity: 0` 到 `translateY(0), opacity: 1`

### 7.2 卡片删除动画
- 向右滑出 + 淡出（300ms ease-in）
- 从 `translateX(0), opacity: 1` 到 `translateX(100px), opacity: 0`
- 删除前弹出确认对话框

### 7.3 状态指示灯脉冲
- **已激活**：绿灯，脉冲动画 `scale: 1 ↔ 1.2`，2s 循环
- **连接错误**：红灯，不闪烁，持续显示警告状态

### 7.4 对话框出现/消失
- **打开**：从中心缩放 `scale: 0.9, opacity: 0` 到 `scale: 1, opacity: 1`，200ms ease-out
- **关闭**：反向，200ms ease-in
- **背景**：暗灰色 overlay `rgba(0, 0, 0, 0.5)`，同步过渡

---

## 8. 响应式设计

### 8.1 桌面版（≥ 1200px）
- 侧边栏固定宽度 280px
- 卡片最大宽度 800px
- 两列布局（侧栏 + 主内容）

### 8.2 平板版（768px ~ 1199px）
- 侧边栏可折叠（汉堡菜单 ☰）
- 卡片最大宽度 600px
- 内容区内边距减少到 20px

### 8.3 移动版（< 768px）
- 应用场景：桌面应用在小窗口下
- 侧边栏隐藏，导航改为顶部标签栏
- 卡片 100% 宽度，内边距 16px

---

## 9. 键盘快捷键 & 无障碍

### 9.1 快捷键
- **Tab**：在卡片和按钮间导航
- **Enter**：激活聚焦元素（按钮、下拉框选项）
- **Escape**：关闭对话框或下拉菜单
- **Ctrl+K**：快速打开"添加模型"对话框

### 9.2 屏幕阅读器支持
- 所有按钮有 `aria-label`
- 卡片有 `role="region"` 和 `aria-labelledby="card-title"`
- 状态指示器有 `aria-live="polite"` 以通知状态变化
- 对话框有 `role="dialog"` 和 `aria-modal="true"`

### 9.3 颜色对比度
- 所有文字与背景对比度 ≥ 4.5:1（符合 WCAG AA）
- 状态指示灯配备文字标签（不仅依赖颜色）

---

## 10. 技术实现提示

### 10.1 React 组件结构
```jsx
<LLMConfigPage>
  <Sidebar activeTab="llm-config" />
  <MainContent>
    <HeaderBar title="LLM 配置" onAddModel={openAddModal} />
    <ModelList models={models}>
      {models.map(model => (
        <ModelCard 
          key={model.id} 
          model={model}
          onEdit={handleEdit}
          onDelete={handleDelete}
          onTest={handleTest}
          onSetDefault={handleSetDefault}
        />
      ))}
    </ModelList>
    {models.length === 0 && <EmptyState />}
  </MainContent>
  
  {showAddModal && (
    <AddModelModal 
      onSave={handleSaveModel}
      onTest={handleTestConnection}
      onClose={closeAddModal}
    />
  )}
</LLMConfigPage>
```

### 10.2 状态管理建议
- 使用 **Zustand** 或 **Jotai** 管理模型列表、当前选中模型
- 使用 **React Query** 缓存 API 连接测试结果
- 本地存储使用 **Electron 的 ipcMain** 与主进程通信，加密保存 API Key

### 10.3 样式方案
- **Tailwind CSS** + 自定义 Tailwind Config 定义颜色变量
- **Framer Motion** 处理动画
- 或使用 **Styled Components** + **react-spring** 实现更细致的动画

### 10.4 表单验证
- API Key 输入框：前端显示 "最少 20 字符" 提示
- 供应商选择：必选项
- 测试连接成功后，"保存"按钮才可用

---

## 11. 设计资源清单

### 11.1 图标
- 菱形 `◆`、圆形 `●`、空心圆 `◯`、警告三角 `⚠`
- 编辑 ✏、删除 🗑、收藏 ☆/★、设置 ⚙、加号 +、右箭头 →、眼睛 👁

### 11.2 颜色变量表
```css
:root {
  /* 品牌色 */
  --brand-primary: #D91B5C;
  --brand-gradient: linear-gradient(135deg, #D91B5C 0%, #C2185B 100%);
  
  /* 背景 */
  --bg-page: #F5F7FA;
  --bg-card: #FFFFFF;
  --bg-input: #F9FAFB;
  --bg-sidebar: var(--brand-gradient);
  
  /* 文字 */
  --text-primary: #1F2937;
  --text-secondary: #6B7280;
  --text-muted: #9CA3AF;
  --text-white: #FFFFFF;
  
  /* 边框 */
  --border-default: #E5E7EB;
  --border-dark: #D1D5DB;
  
  /* 状态色 */
  --success: #10B981;
  --error: #EF4444;
  --warning: #F59E0B;
  --info: #3B82F6;
}
```

### 11.3 字体
- 主字体：Noto Sans SC、PingFang SC（中文）、Inter（英文）
- 等宽字体（API Key 显示）：JetBrains Mono、Fira Code

---

## 12. 验收标准

### 12.1 视觉还原度
- [ ] 侧边栏渐变色与原型一致
- [ ] 导航项 active 状态有左侧竖线指示器
- [ ] 卡片阴影和圆角符合规范
- [ ] 状态指示器（●/◯/⚠）颜色准确
- [ ] 模态对话框背景 overlay 正确显示

### 12.2 交互流畅性
- [ ] 卡片加载动画平滑（60fps）
- [ ] 对话框打开/关闭无闪烁
- [ ] 按钮 hover/click 反应 < 100ms
- [ ] 下拉菜单展开流畅

### 12.3 功能完整性
- [ ] 可添加新模型
- [ ] 模型连接测试正常工作
- [ ] 删除模型弹出确认框
- [ ] 设为默认后，卡片状态正确更新
- [ ] 收藏/取消收藏功能正常

### 12.4 表单验证
- [ ] 未输入 API Key 时"保存"按钮禁用
- [ ] 连接失败时显示错误信息
- [ ] 测试成功后自动填充模型信息

### 12.5 跨平台一致性
- [ ] Windows 和 macOS 上侧边栏宽度一致
- [ ] 字体渲染清晰
- [ ] 颜色在两平台显示一致

---

**文档版本**：v1.0  
**最后更新**：2025-11-12  
**维护者**：产品设计团队

